<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
</head>
<body m:id='CONTENT'>
  <script>
  window.DataList= [
  <? var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('data');
     var category_sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('category_data');
     var dataCount = sheet.getLastRow() - 1;
     var categoryCount = 5;
     var data = sheet.getRange(2,1,dataCount,categoryCount).getValues();
     var category_data = category_sheet.getRange(2,2,dataCount,categoryCount).getValues();
     
     for(i = 0; i < dataCount; i++) { ?>
      {
        name: <?= data[i][0] ?>,
        kana: <?= data[i][1] ?>,
        id: <?= data[i][2] ?>,
        image_name: <?= data[i][3] ?>,
        category: [<? for(j = 0; j < categoryCount; j++) {
        if ( category_data[i][j] === 'â—¯') { ?><?= j ?>,<? } } ?>]
      },
 <? } ?>
  ];
  </script>

</body>
</html>


